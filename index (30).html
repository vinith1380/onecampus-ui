<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Import and Part Rejection Data Visualization</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- SheetJS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #e0e7ff, #f3f4f6);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .card {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            border-radius: 15px;
            border: none;
        }
        .card-title {
            color: #1e3a8a;
            font-weight: 600;
        }
        .alert {
            border-radius: 10px;
            font-weight: 500;
        }
        .chart-container {
            margin-bottom: 2.5rem;
        }
        .btn-custom {
            border-radius: 20px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .table-responsive {
            border-radius: 10px;
            overflow-x: auto;
            overflow-y: auto;
            max-height: 400px;
        }
        .table-dark th {
            background-color: #1e3a8a;
            color: white;
        }
        .modal-content {
            border-radius: 15px;
        }
        .list-group-item {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .list-group-item:hover {
            background-color: #e0e7ff;
        }
        .delete-btn {
            float: right;
            margin-left: 10px;
        }
        #mainContent {
            display: none;
        }
        .filter-select {
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ced4da;
            width: 100%;
        }
        .table th, .table td {
            min-width: 150px;
            white-space: nowrap;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-custom">Login</button>
                    </form>
                    <div id="loginError" class="text-danger mt-2" style="display: none;">Invalid username or password.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container my-5" id="mainContent">
        <button class="btn btn-danger btn-custom logout-btn" id="logoutBtn">Logout</button>
        <h2 class="text-center mb-4 fw-bold">Part Rejection Data Analysis</h2>
        <div class="card mb-4">
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div id="uploadSection">
                            <label for="excelFile" class="form-label fw-semibold">Upload Excel File:</label>
                            <input type="file" class="form-control" id="excelFile" accept=".xlsx, .xls">
                        </div>
                    </div>
                    <div class="col-md-6 d-flex align-items-end">
                        <div class="ms-auto">
                            <button class="btn btn-primary btn-custom me-2" id="viewData" data-bs-toggle="modal" data-bs-target="#weekModal">View Data</button>
                            <button class="btn btn-primary btn-custom me-2" id="prevWeek" disabled>Previous Week</button>
                            <button class="btn btn-primary btn-custom" id="nextWeek" disabled>Next Week</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div id="totalCost" class="alert alert-info" style="display: none;">
                            Total Rejection Cost: <span id="costValue">0</span> INR
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div id="totalRejections" class="alert alert-warning" style="display: none;">
                            Total Rejections Count: <span id="rejectionsValue">0</span>
                        </div>
                    </div>
                </div>
                <div class="alert alert-secondary text-center" id="currentWeek" style="display: none;">
                    Current Week: <span id="weekValue">None</span>
                </div>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-body">
                <h4 class="card-title fw-semibold">Uploaded Excel Data</h4>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered" id="dataTable">
                        <thead class="table-dark">
                            <tr id="filterRow">
                                <th><select class="filter-select" data-column="0"></select></th>
                                <th><select class="filter-select" data-column="1"></select></th>
                                <th><select class="filter-select" data-column="2"></select></th>
                                <th><select class="filter-select" data-column="3"></select></th>
                                <th><select class="filter-select" data-column="4"></select></th>
                                <th><select class="filter-select" data-column="5"></select></th>
                                <th><select class="filter-select" data-column="6"></select></th>
                                <th><select class="filter-select" data-column="7"></select></th>
                                <th><select class="filter-select" data-column="8"></select></th>
                                <th><select class="filter-select" data-column="9"></select></th>
                                <th><select class="filter-select" data-column="10"></select></th>
                                <th><select class="filter-select" data-column="11"></select></th>
                            </tr>
                            <tr>
                                <th>Component Part Number</th>
                                <th>Consumed</th>
                                <th>Mispick</th>
                                <th>Not Placed</th>
                                <th>Total Rejections</th>
                                <th>Cost /Part</th>
                                <th>TOTAL PARTS</th>
                                <th>TOTAL PARTS BY VALUE</th>
                                <th>Reuse Parts</th>
                                <th>Re-use Cost Savings</th>
                                <th>Total Part Rejections Cost in INR</th>
                                <th>CAPA Given for High Rejection Parts</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6 chart-container">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title fw-semibold">Top 10 Parts by Rejection Cost</h4>
                        <canvas id="costChart" width="400" height="400"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 chart-container">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title fw-semibold">Top 10 Parts by Total Rejections</h4>
                        <canvas id="rejectionChart" width="400" height="400"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Week Selection Modal -->
    <div class="modal fade" id="weekModal" tabindex="-1" aria-labelledby="weekModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="weekModalLabel">Select Week Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="list-group" id="weekList"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Register Chart.js data labels plugin
        Chart.register(ChartDataLabels);

        let costChartInstance = null;
        let rejectionChartInstance = null;
        let weekData = JSON.parse(localStorage.getItem('weekData')) || {};
        let weekKeys = Object.keys(weekData).sort();
        let currentWeekIndex = weekKeys.length > 0 ? weekKeys.length - 1 : -1;
        let userRole = null;
        let currentDataRows = []; // Store current week's data for filtering

        // Show login modal on page load
        document.addEventListener('DOMContentLoaded', function () {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'), { backdrop: 'static', keyboard: false });
            loginModal.show();
        });

        // Handle login
        document.getElementById('loginForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const loginError = document.getElementById('loginError');

            if (username === 'mfg' && password === 'mfg') {
                userRole = 'user';
                document.getElementById('uploadSection').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                updateUI();
            } else if (username === 'admin' && password === 'admin') {
                userRole = 'admin';
                document.getElementById('uploadSection').style.display = 'block';
                document.getElementById('mainContent').style.display = 'block';
                bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                updateUI();
            } else {
                loginError.style.display = 'block';
            }
        });

        // Handle logout
        document.getElementById('logoutBtn').addEventListener('click', function () {
            userRole = null;
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').style.display = 'none';
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'), { backdrop: 'static', keyboard: false });
            loginModal.show();
        });

        // Update UI based on current week and user role
        function updateUI() {
            const prevButton = document.getElementById('prevWeek');
            const nextButton = document.getElementById('nextWeek');
            const weekList = document.getElementById('weekList');
            prevButton.disabled = currentWeekIndex <= 0;
            nextButton.disabled = currentWeekIndex >= weekKeys.length - 1 || weekKeys.length === 0;

            // Populate modal with week names
            weekList.innerHTML = '';
            if (weekKeys.length === 0) {
                weekList.innerHTML = '<p class="text-muted">No data available. Please upload an Excel file.</p>';
            } else {
                weekKeys.forEach(week => {
                    const item = document.createElement('div');
                    item.className = 'list-group-item d-flex justify-content-between align-items-center';
                    const weekLink = document.createElement('a');
                    weekLink.className = 'flex-grow-1';
                    weekLink.textContent = week;
                    weekLink.style.cursor = 'pointer';
                    weekLink.addEventListener('click', () => {
                        currentWeekIndex = weekKeys.indexOf(week);
                        updateUI();
                        bootstrap.Modal.getInstance(document.getElementById('weekModal')).hide();
                    });
                    item.appendChild(weekLink);
                    if (userRole === 'admin') {
                        const deleteBtn = document.createElement('button');
                        deleteBtn.className = 'btn btn-danger btn-sm delete-btn';
                        deleteBtn.textContent = 'Delete';
                        deleteBtn.addEventListener('click', () => {
                            if (confirm(`Are you sure you want to delete data for ${week}?`)) {
                                delete weekData[week];
                                localStorage.setItem('weekData', JSON.stringify(weekData));
                                weekKeys = Object.keys(weekData).sort();
                                currentWeekIndex = Math.min(currentWeekIndex, weekKeys.length - 1);
                                if (currentWeekIndex < 0) currentWeekIndex = -1;
                                updateUI();
                                bootstrap.Modal.getInstance(document.getElementById('weekModal')).hide();
                            }
                        });
                        item.appendChild(deleteBtn);
                    }
                    weekList.appendChild(item);
                });
            }

            if (currentWeekIndex >= 0) {
                const week = weekKeys[currentWeekIndex];
                document.getElementById('weekValue').textContent = week;
                document.getElementById('currentWeek').style.display = 'block';
                renderData(weekData[week]);
            } else {
                document.getElementById('currentWeek').style.display = 'none';
                document.getElementById('totalCost').style.display = 'none';
                document.getElementById('totalRejections').style.display = 'none';
                document.getElementById('tableBody').innerHTML = '';
                if (costChartInstance) costChartInstance.destroy();
                if (rejectionChartInstance) rejectionChartInstance.destroy();
                // Clear filter dropdowns
                document.querySelectorAll('.filter-select').forEach(select => {
                    select.innerHTML = '<option value="">All</option>';
                });
            }
        }

        // Handle file upload
        document.getElementById('excelFile').addEventListener('change', function (e) {
            if (userRole !== 'admin') return; // Only admin can upload
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });

                // Process all sheets (assuming each sheet is a week, e.g., WW34)
                workbook.SheetNames.forEach(sheetName => {
                    if (sheetName.match(/^WW\d+$/)) { // Only process sheets like WW34, WW35, etc.
                        const worksheet = workbook.Sheets[sheetName];
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        weekData[sheetName] = jsonData;
                    }
                });

                // Update localStorage and weekKeys
                localStorage.setItem('weekData', JSON.stringify(weekData));
                weekKeys = Object.keys(weekData).sort();
                currentWeekIndex = weekKeys.length - 1; // Set to latest week
                updateUI();
            };
            reader.readAsArrayBuffer(file);
        });

        // Previous and Next week navigation
        document.getElementById('prevWeek').addEventListener('click', function () {
            if (currentWeekIndex > 0) {
                currentWeekIndex--;
                updateUI();
            }
        });

        document.getElementById('nextWeek').addEventListener('click', function () {
            if (currentWeekIndex < weekKeys.length - 1) {
                currentWeekIndex++;
                updateUI();
            }
        });

        // Populate filter dropdowns
        function populateFilters(dataRows) {
            const selects = document.querySelectorAll('.filter-select');
            selects.forEach((select, index) => {
                const values = new Set(dataRows.map(row => row[index] !== undefined ? row[index].toString() : ''));
                select.innerHTML = '<option value="">All</option>';
                values.forEach(value => {
                    const option = document.createElement('option');
                    option.value = value;
                    option.textContent = value || '(Empty)';
                    select.appendChild(option);
                });
            });
        }

        // Filter table
        function applyFilters() {
            const filters = Array.from(document.querySelectorAll('.filter-select')).map(select => select.value);
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            currentDataRows.forEach(row => {
                let matches = true;
                filters.forEach((filter, index) => {
                    if (filter) {
                        const cellValue = row[index] !== undefined ? row[index].toString() : '';
                        if (cellValue !== filter) {
                            matches = false;
                        }
                    }
                });

                if (matches) {
                    const tr = document.createElement('tr');
                    row.forEach(cell => {
                        const td = document.createElement('td');
                        td.textContent = cell !== undefined ? cell : '';
                        tr.appendChild(td);
                    });
                    tableBody.appendChild(tr);
                }
            });
        }

        // Add filter event listeners
        document.querySelectorAll('.filter-select').forEach(select => {
            select.addEventListener('change', applyFilters);
        });

        // Render data for a specific week
        function renderData(jsonData) {
            // Extract headers and data rows
            const headers = jsonData[1]; // Row 2 contains headers
            currentDataRows = jsonData.slice(2); // Data starts from row 3, store for filtering

            // Populate filter dropdowns
            populateFilters(currentDataRows);

            // Filter out rows where Total Rejections is 0 or undefined for calculations
            const validRows = currentDataRows.filter(row => row[4] && row[4] > 0);

            // Calculate total rejection cost
            const totalCost = validRows.reduce((sum, row) => {
                const cost = parseFloat(row[10]) || 0; // Total Part Rejections Cost in INR
                return sum + cost;
            }, 0).toFixed(2);

            // Calculate total rejections count
            const totalRejections = validRows.reduce((sum, row) => {
                const count = parseInt(row[4]) || 0; // Total Rejections
                return sum + count;
            }, 0);

            // Display total cost and total rejections
            document.getElementById('costValue').textContent = totalCost;
            document.getElementById('totalCost').style.display = 'block';
            document.getElementById('rejectionsValue').textContent = totalRejections;
            document.getElementById('totalRejections').style.display = 'block';

            // Populate table (initially unfiltered)
            applyFilters();

            // Prepare data for cost chart (top 10 by rejection cost)
            const sortedByCost = validRows
                .map(row => ({
                    partNumber: row[0],
                    rejectionCost: parseFloat(row[10]) || 0,
                    rejectionCount: parseInt(row[4]) || 0
                }))
                .filter(item => item.rejectionCost > 0)
                .sort((a, b) => b.rejectionCost - a.rejectionCost)
                .slice(0, 10);

            const costLabels = sortedByCost.map(item => item.partNumber);
            const costs = sortedByCost.map(item => item.rejectionCost);
            const costRejections = sortedByCost.map(item => item.rejectionCount);

            // Prepare data for rejection chart (top 10 by total rejections)
            const sortedByRejections = validRows
                .map(row => ({
                    partNumber: row[0],
                    rejectionCount: parseInt(row[4]) || 0,
                    rejectionCost: parseFloat(row[10]) || 0
                }))
                .filter(item => item.rejectionCount > 0)
                .sort((a, b) => b.rejectionCount - a.rejectionCount)
                .slice(0, 10);

            const rejectionLabels = sortedByRejections.map(item => item.partNumber);
            const rejections = sortedByRejections.map(item => item.rejectionCount);
            const rejectionCosts = sortedByRejections.map(item => item.rejectionCost);

            // Destroy existing charts if they exist
            if (costChartInstance) costChartInstance.destroy();
            if (rejectionChartInstance) rejectionChartInstance.destroy();

            // Create gradient for cost chart
            const costCtx = document.getElementById('costChart').getContext('2d');
            const costGradient = costCtx.createLinearGradient(0, 0, 0, 400);
            costGradient.addColorStop(0, 'rgba(54, 162, 235, 0.9)');
            costGradient.addColorStop(1, 'rgba(54, 162, 235, 0.4)');
            const countGradient = costCtx.createLinearGradient(0, 0, 0, 400);
            countGradient.addColorStop(0, 'rgba(255, 99, 132, 0.9)');
            countGradient.addColorStop(1, 'rgba(255, 99, 132, 0.4)');

            // Create cost chart
            costChartInstance = new Chart(costCtx, {
                type: 'bar',
                data: {
                    labels: costLabels,
                    datasets: [
                        {
                            label: 'Rejection Cost (INR)',
                            data: costs,
                            backgroundColor: costGradient,
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                            yAxisID: 'yCost'
                        },
                        {
                            label: 'Total Rejections (Count)',
                            data: costRejections,
                            backgroundColor: countGradient,
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                            yAxisID: 'yCount'
                        }
                    ]
                },
                options: {
                    scales: {
                        yCost: {
                            type: 'linear',
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cost in INR',
                                color: 'rgba(54, 162, 235, 1)',
                                font: { weight: 'bold', size: 14 }
                            },
                            grid: { drawOnChartArea: true }
                        },
                        yCount: {
                            type: 'linear',
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Rejection Count',
                                color: 'rgba(255, 99, 132, 1)',
                                font: { weight: 'bold', size: 14 }
                            },
                            grid: { drawOnChartArea: false }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Component Part Number',
                                font: { weight: 'bold', size: 14 }
                            }
                        }
                    },
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: { font: { size: 14 }, padding: 20 }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleFont: { size: 14 },
                            bodyFont: { size: 12 },
                            padding: 10
                        },
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 10 },
                            formatter: (value) => value.toFixed(2),
                            anchor: 'end',
                            align: 'top'
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutElastic'
                    }
                }
            });

            // Create gradient for rejection chart
            const rejectionCtx = document.getElementById('rejectionChart').getContext('2d');
            const rejectionGradient = rejectionCtx.createLinearGradient(0, 0, 0, 400);
            rejectionGradient.addColorStop(0, 'rgba(255, 99, 132, 0.9)');
            rejectionGradient.addColorStop(1, 'rgba(255, 99, 132, 0.4)');
            const costGradient2 = rejectionCtx.createLinearGradient(0, 0, 0, 400);
            costGradient2.addColorStop(0, 'rgba(54, 162, 235, 0.9)');
            costGradient2.addColorStop(1, 'rgba(54, 162, 235, 0.4)');

            // Create rejection chart
            rejectionChartInstance = new Chart(rejectionCtx, {
                type: 'bar',
                data: {
                    labels: rejectionLabels,
                    datasets: [
                        {
                            label: 'Total Rejections (Count)',
                            data: rejections,
                            backgroundColor: rejectionGradient,
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                            yAxisID: 'yCount'
                        },
                        {
                            label: 'Rejection Cost (INR)',
                            data: rejectionCosts,
                            backgroundColor: costGradient2,
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1,
                            borderRadius: 10,
                            yAxisID: 'yCost'
                        }
                    ]
                },
                options: {
                    scales: {
                        yCount: {
                            type: 'linear',
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Rejection Count',
                                color: 'rgba(255, 99, 132, 1)',
                                font: { weight: 'bold', size: 14 }
                            },
                            grid: { drawOnChartArea: true }
                        },
                        yCost: {
                            type: 'linear',
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cost in INR',
                                color: 'rgba(54, 162, 235, 1)',
                                font: { weight: 'bold', size: 14 }
                            },
                            grid: { drawOnChartArea: false }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Component Part Number',
                                font: { weight: 'bold', size: 14 }
                            }
                        }
                    },
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: { font: { size: 14 }, padding: 20 }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleFont: { size: 14 },
                            bodyFont: { size: 12 },
                            padding: 10
                        },
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 10 },
                            formatter: (value) => value.toFixed(2),
                            anchor: 'end',
                            align: 'top'
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutElastic'
                    }
                }
            });
        }
    </script>

    <!-- Bootstrap JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>